<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>To-Do List</title>
    <link rel="stylesheet" href="domsty.css" />
  </head>
  <body>
    <div class="container">
      <h1><span style="color: green; font-size: 60 px;"> ‚úìT</span>ODO LIST</h1>

      <div class="input-section">
        <input type="text" placeholder="Enter a new task..." />
        <button onclick="addtodo()">Add Todo</button>
      </div>

      <ul id="todo-list"></ul>
    </div>

    <script>
      let ctr = 1;

      function deltodo(index) {
        const element = document.getElementById("todo-" + index);
        element.parentNode.removeChild(element);

        checkEmptyState();
      }

      function toggleComplete(index) {
        const todoItem = document.getElementById("todo-" + index);
        const checkbox = todoItem.querySelector(".todo-checkbox");

        if (checkbox.checked) {
          todoItem.classList.add("completed");
        } else {
          todoItem.classList.remove("completed");
        }
      }

      function edittodo(index) {
        const todoLi = document.getElementById("todo-" + index);
        const textDiv = todoLi.querySelector(".todo-text");
        const currentText = textDiv.innerText;
        const checkbox = todoLi.querySelector(".todo-checkbox");
        const isCompleted = checkbox.checked;

        todoLi.innerHTML =
          "<div class='todo-content'>" +
          "<input type='checkbox' class='todo-checkbox' " +
          (isCompleted ? "checked" : "") +
          " disabled>" +
          "<input type='text' value='" +
          currentText +
          "' id='edit-input-" +
          index +
          "' style='flex-grow: 1;'>" +
          "</div>" +
          "<div class='todo-buttons'>" +
          "<button class='save-btn' onclick='savetodo(" +
          index +
          ")'>Save</button>" +
          "<button class='cancel-btn' onclick='canceledit(" +
          index +
          ', "' +
          currentText +
          '", ' +
          isCompleted +
          ")'>Cancel</button>" +
          "</div>";

        const editInput = document.getElementById("edit-input-" + index);
        editInput.focus();
        editInput.select();

        editInput.addEventListener("keydown", function (event) {
          if (event.key === "Enter") {
            savetodo(index);
          } else if (event.key === "Escape") {
            canceledit(index, currentText, isCompleted);
          }
        });
      }

      function savetodo(index) {
        const editInput = document.getElementById("edit-input-" + index);
        const newText = editInput.value.trim();
        const todoLi = document.getElementById("todo-" + index);
        const checkbox = todoLi.querySelector(".todo-checkbox");
        const isCompleted = checkbox.checked;

        if (!newText) {
          alert("Todo cannot be empty!");
          return;
        }

        todoLi.innerHTML =
          "<div class='todo-content'>" +
          "<input type='checkbox' class='todo-checkbox' " +
          (isCompleted ? "checked" : "") +
          " onchange='toggleComplete(" +
          index +
          ")'>" +
          "<div class='todo-text'>" +
          newText +
          "</div>" +
          "</div>" +
          "<div class='todo-buttons'>" +
          "<button class='edit-btn' onclick='edittodo(" +
          index +
          ")'>Edit</button>" +
          "<button class='delete-btn' onclick='deltodo(" +
          index +
          ")'>Delete</button>" +
          "</div>";

        if (isCompleted) {
          todoLi.classList.add("completed");
        }
      }

      function canceledit(index, originalText, wasCompleted) {
        const todoLi = document.getElementById("todo-" + index);
        todoLi.innerHTML =
          "<div class='todo-content'>" +
          "<input type='checkbox' class='todo-checkbox' " +
          (wasCompleted ? "checked" : "") +
          " onchange='toggleComplete(" +
          index +
          ")'>" +
          "<div class='todo-text'>" +
          originalText +
          "</div>" +
          "</div>" +
          "<div class='todo-buttons'>" +
          "<button class='edit-btn' onclick='edittodo(" +
          index +
          ")'>Edit</button>" +
          "<button class='delete-btn' onclick='deltodo(" +
          index +
          ")'>Delete</button>" +
          "</div>";

        if (wasCompleted) {
          todoLi.classList.add("completed");
        }
      }

      function addtodo() {
        const inputval = document.querySelector("input");
        const value = inputval.value.trim();
        if (!value) {
          alert("Please enter a todo item");
          return;
        }

        removeEmptyState();

        const newli = document.createElement("li");
        newli.setAttribute("id", "todo-" + ctr);
        newli.className = "todo-item";
        newli.innerHTML =
          "<div class='todo-content'>" +
          "<input type='checkbox' class='todo-checkbox' onchange='toggleComplete(" +
          ctr +
          ")'>" +
          "<div class='todo-text'>" +
          value +
          "</div>" +
          "</div>" +
          "<div class='todo-buttons'>" +
          "<button class='edit-btn' onclick='edittodo(" +
          ctr +
          ")'>Edit</button>" +
          "<button class='delete-btn' onclick='deltodo(" +
          ctr +
          ")'>Delete</button>" +
          "</div>";

        document.getElementById("todo-list").appendChild(newli);
        inputval.value = "";
        inputval.focus();
        ctr++;
      }

      function checkEmptyState() {
        const todoList = document.getElementById("todo-list");
        if (todoList.children.length === 0) {
          const emptyState = document.createElement("div");
          emptyState.className = "empty-state";
          emptyState.id = "empty-state";
          emptyState.innerHTML = "No tasks yet. Add one above! üìù";
          todoList.appendChild(emptyState);
        }
      }

      function removeEmptyState() {
        const emptyState = document.getElementById("empty-state");
        if (emptyState) {
          emptyState.remove();
        }
      }

      document
        .querySelector("input")
        .addEventListener("keydown", function (event) {
          if (event.key === "Enter") {
            addtodo();
          }
        });

      checkEmptyState();
    </script>
  </body>
</html>
